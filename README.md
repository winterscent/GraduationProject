# GraduationProject : 대화 분석을 통한 관계 평가 서비스 (Relationship Evaluation Service through Conversation Analysis)

- Backend_API 기준 설명

1. User가 카카오톡 대화 내용이 담긴 .csv 혹은 .txt 파일과 지정 날짜를 업로드. 
2. 지정 날짜의 순서가 맞는 지 검사하고, 파일의 형식을 모두 .csv 파일 형식으로 통일. 
3. Mac, Windows, iOS, Android 모두 카카오톡에서 대화 내용을 추출하게 되면, 양식이 각각 다르기 때문에 이 양식을 convert_txt_to_csv.py를 통해 .csv 파일 형식으로 통일하고 파일 내 순서를 날짜/사용자/대화 내용 순으로 정렬.
4. 개인정보 보안을 위해 name_masking.py를 통해 사용자의 이름을 모두 마스킹 처리하고 지정 날짜만큼만 데이터를 잘라냄.
5. 이렇게 가공된 데이터를 conversation_analysis.py에서 처리하는데, 먼저 기존에 마련되어 있었던 학습 데이터인 conversation_models.py에 있는 데이터셋을 Okt 라이브러리를 활용하여 형태소를 모두 분리한 다음 코사인 유사도와 유클리드 거리를 활용하여 벡터화.
6. 이전에 가공한 데이터 역시 같은 방식으로 Okt 라이브러리를 활용하여 형태소 모두 분리 후 코사인 유사도와 유클리드 거리를 활용하여 벡터화.
7. 기존 데이터의 4가지 카테고리와 가공된 데이터의 벡터값을 서로 비교하여 가장 유사한 카테고리에 지정. 
8. 가공된 데이터에서 최근 대화 50개 라인(700자가 넘어간다면 700자 이전까지의 라인)을 추출.
9. chatgpt_api.py를 통해 ChatGPT API에 벡터값으로 계산하여 나온 결과값(모든 점수와 지정된 카테고리 포함)과 최근 대화 50개 라인까지의 데이터를 전송하고 응답 수신. 
10. 이후 대화 내용은 s3_utils.py를 통해 AWS S3에, 결과값과 대화 내용이 저장된 S3 URL은 DB에 저장 후 서비스에 결과값과 ChatGPT API 응답 반환. 
